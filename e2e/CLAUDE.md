# E2Eテスト (e2e/) - CLAUDE.md

このファイルはE2Eテストワークスペース固有のClaude Codeガイダンスを提供します。

## テストアーキテクチャ

### E2Eテスト構成
- **フレームワーク**: Playwright with TypeScript
- **テスト戦略**: フルスタックアプリケーションのエンドツーエンドテスト
- **環境**: ローカル開発環境での統合テスト
- **データ管理**: テスト実行前にDB/バケットのリセット
- **構造**: 
  - `tests/` - テストケース
  - `helpers/` - テストヘルパー関数

### テスト対象範囲
- ユーザーインタラクションフロー
- フロントエンド・バックエンド連携
- データベース操作
- ファイルアップロード機能
- レスポンシブデザイン

## 開発コマンド

### E2Eテスト実行
```bash
pnpm test              # Playwrightテスト実行
```

### UIモードでテスト実行
```bash
pnpm test:ui           # ブラウザUIでインタラクティブにテスト実行
```

### その他のPlaywrightコマンド
```bash
npx playwright codegen  # テストコード生成
npx playwright show-report  # テストレポート表示
```

## 重要なファイル

- `playwright.config.ts` - Playwrightテスト設定
- `tests/` - テストケースディレクトリ
- `helpers/` - テストヘルパー関数
- `tsconfig.json` - TypeScript設定

## テスト戦略

### テストデータ管理
- テスト実行前にデータベースとR2バケットをリセット
- 予測可能な状態でテスト実行
- 各テストケースが独立して実行可能

### テストケース構成
- **機能テスト**: 主要機能の動作確認
- **インテグレーションテスト**: フロントエンド・バックエンド連携
- **UIテスト**: ユーザーインタラクションの確認
- **レスポンシブテスト**: 各画面サイズでの動作確認

### テスト環境
- ローカル開発環境（localhost:5173, localhost:8787）
- フロントエンド・バックエンド両方が起動している状態で実行
- 本番環境に近い条件でのテスト

## 開発ワークフロー

1. フロントエンド・バックエンドの開発サーバー起動
2. E2Eテスト実行でエンドツーエンド動作確認
3. テスト失敗時は対象機能の修正
4. UIモードでデバッグ・新規テスト作成

### E2E固有の開発指針

- 実際のユーザー操作に近いテストケース作成
- テストの安定性を重視（flakyテストを避ける）
- 適切な待機条件設定
- 意味のあるテストデータ使用
- テストケースの可読性向上

### デバッグとトラブルシューティング

- Playwright UIモードでステップバイステップ実行
- スクリーンショット・動画記録機能活用
- ネットワーク通信ログの確認
- ブラウザ開発者ツールとの連携

### パフォーマンステスト

- ページ読み込み時間の監視
- API レスポンス時間の測定
- メモリリークの検出
- リソース使用量の確認