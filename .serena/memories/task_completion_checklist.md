# タスク完了チェックリスト

## 基本的な品質確認（全タスク共通）

### 1. 型安全性確認
```bash
# 必須：全体の型チェック
pnpm typecheck
```
**チェックポイント**:
- [ ] バックエンドの型エラーがない
- [ ] フロントエンドの型エラーがない
- [ ] 型定義の整合性が取れている
- [ ] エンドツーエンドの型安全性が保たれている

### 2. コード品質確認
```bash
# 必須：リントチェック
pnpm -r lint
```
**チェックポイント**:
- [ ] ESLintエラーがない
- [ ] コードフォーマットが統一されている
- [ ] インポート順序が正しい
- [ ] オニオンアーキテクチャの依存方向が守られている（バックエンド）

### 3. 単体テスト確認
```bash
# 必須：単体テスト実行
pnpm test:unit
```
**チェックポイント**:
- [ ] 既存テストが全て通る
- [ ] 新しい機能にテストが追加されている（該当時）
- [ ] テストカバレッジが維持されている

## 機能追加・修正時の追加確認

### 4. API統合テスト確認
```bash
# API変更時必須
pnpm test:api
```
**チェックポイント**:
- [ ] Brunoテストが全て通る
- [ ] 新しいAPIエンドポイントにテストが追加されている（該当時）
- [ ] APIの契約が既存クライアントと互換性がある

### 5. E2Eテスト確認
```bash
# UI変更時必須
pnpm test:e2e
```
**チェックポイント**:
- [ ] Playwrightテストが全て通る
- [ ] 重要なユーザーフローが動作する
- [ ] 新しい機能のE2Eテストが追加されている（該当時）

## 機能別チェックリスト

### バックエンド機能開発時

#### ドメイン層変更
- [ ] エンティティのビジネスルールが正しい
- [ ] 値オブジェクトのバリデーションが適切
- [ ] ドメインテストが追加・更新されている
- [ ] 外部依存が一切ない

#### アプリケーション層変更
- [ ] ユースケースが単一責務を守っている
- [ ] リポジトリインターフェースが適切
- [ ] DTOが正しく定義されている
- [ ] ユースケーステストが追加・更新されている

#### インフラストラクチャ層変更
- [ ] リポジトリ実装が適切
- [ ] データベーススキーマが正しい
- [ ] マイグレーションが作成されている（該当時）
- [ ] インフラテストが追加・更新されている

#### プレゼンテーション層変更
- [ ] APIルートが適切に定義されている
- [ ] バリデーションが実装されている
- [ ] エラーハンドリングが適切
- [ ] AppType の型が正しくエクスポートされている
- [ ] Brunoテストが追加・更新されている

### フロントエンド機能開発時

#### コンポーネント開発
- [ ] 型安全なpropsが定義されている
- [ ] TailwindCSSが適切に使用されている
- [ ] アクセシビリティが考慮されている
- [ ] コンポーネントテストが追加・更新されている

#### ルート開発
- [ ] ローダー/アクションが型安全
- [ ] エラーバウンダリーが適切
- [ ] SEO対応（meta tags等）が実装されている
- [ ] ルートテストが追加・更新されている

#### API統合
- [ ] 型付きクライアントが使用されている
- [ ] エラーハンドリングが適切
- [ ] ローディング状態が適切に管理されている
- [ ] APIクライアントテストが追加・更新されている

## デプロイ前の最終確認

### 完全品質チェック
```bash
# 全品質チェック実行（CI相当）
pnpm check-all
```

### デプロイ準備確認
- [ ] 環境変数が正しく設定されている
- [ ] wrangler.jsonc の設定が適切
- [ ] マイグレーションが本番環境で実行可能
- [ ] 秘匿情報がコードに含まれていない

### セキュリティチェック
- [ ] 認証・認可が適切に実装されている（該当時）
- [ ] SQLインジェクション対策ができている
- [ ] XSS対策ができている
- [ ] CORS設定が適切

## パフォーマンス確認

### バックエンド
- [ ] データベースクエリが最適化されている
- [ ] N+1クエリ問題が発生していない
- [ ] キャッシュが適切に活用されている
- [ ] メモリリークが発生していない

### フロントエンド
- [ ] バンドルサイズが適切
- [ ] 不要な再レンダリングが発生していない
- [ ] 画像最適化が適切
- [ ] Core Web Vitalsが良好

## ドキュメンテーション確認

### コード内ドキュメント
- [ ] TSDocコメントが適切に追加されている
- [ ] 複雑なロジックにコメントが追加されている
- [ ] TODOコメントが適切（将来対応予定のもの）

### 外部ドキュメント
- [ ] CLAUDE.md が更新されている（該当時）
- [ ] API仕様書が更新されている（該当時）
- [ ] README が更新されている（該当時）

## チーム連携確認

### コードレビュー準備
- [ ] コミットメッセージが適切
- [ ] プルリクエスト説明が十分
- [ ] 変更範囲が明確
- [ ] 影響範囲が特定されている

### 本番環境対応
- [ ] ロールバック手順が明確
- [ ] 監視・アラートが設定されている（該当時）
- [ ] ログが適切に出力されている
- [ ] 緊急時の対応手順が明確

## 緊急時・ホットフィックス時の簡略チェック

### 最小限チェック（緊急時のみ）
```bash
# 最低限の確認
pnpm typecheck && pnpm -r lint && pnpm test:unit
```

**緊急時チェックポイント**:
- [ ] 型エラーがない
- [ ] 明らかなリントエラーがない
- [ ] 既存機能を破壊していない
- [ ] セキュリティホールを作っていない

### ホットフィックス後の追加対応
- [ ] 完全なテストスイートを実行
- [ ] 根本原因の分析と対策
- [ ] 再発防止策の実装
- [ ] ドキュメントの更新

## 自動化できる部分

### CI/CDでの自動チェック
```yaml
# GitHub Actions例
- name: Quality Check
  run: pnpm check-all

- name: Security Check  
  run: npm audit

- name: Performance Check
  run: pnpm lighthouse-ci
```

### プリコミットフック
```bash
# husky設定例
pnpm typecheck && pnpm -r lint --fix
```

これらのチェックリストを活用することで、一貫した品質を保ちながら効率的な開発を実現できます。